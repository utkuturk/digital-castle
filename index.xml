<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>digital-castle</title>
<link>https://utkuturk.github.io/digital-castle/</link>
<atom:link href="https://utkuturk.github.io/digital-castle/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.55</generator>
<lastBuildDate>Fri, 06 Dec 2024 05:00:00 GMT</lastBuildDate>
<item>
  <title>Post With Code</title>
  <dc:creator>Harlow Malloc</dc:creator>
  <link>https://utkuturk.github.io/digital-castle/posts/post-with-code/</link>
  <description><![CDATA[ 





<p>This is a post with executable code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{malloc2024,
  author = {Malloc, Harlow},
  title = {Post {With} {Code}},
  date = {2024-12-06},
  url = {https://utkuturk.github.io/digital-castle/posts/post-with-code/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-malloc2024" class="csl-entry quarto-appendix-citeas">
Malloc, Harlow. 2024. <span>“Post With Code.”</span> December 6, 2024.
<a href="https://utkuturk.github.io/digital-castle/posts/post-with-code/">https://utkuturk.github.io/digital-castle/posts/post-with-code/</a>.
</div></div></section></div> ]]></description>
  <category>news</category>
  <category>code</category>
  <category>analysis</category>
  <guid>https://utkuturk.github.io/digital-castle/posts/post-with-code/</guid>
  <pubDate>Fri, 06 Dec 2024 05:00:00 GMT</pubDate>
  <media:content url="https://utkuturk.github.io/digital-castle/posts/post-with-code/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Welcome To My Blog</title>
  <dc:creator>Tristan O&#39;Malley</dc:creator>
  <link>https://utkuturk.github.io/digital-castle/posts/welcome/</link>
  <description><![CDATA[ 





<p>This is the first post in a Quarto blog. Welcome!</p>
<p><img src="https://utkuturk.github.io/digital-castle/posts/welcome/thumbnail.jpg" class="img-fluid"></p>
<p>Since this post doesn’t specify an explicit <code>image</code>, the first image in the post will be used in the listing page of posts.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{o'malley2024,
  author = {O’Malley, Tristan},
  title = {Welcome {To} {My} {Blog}},
  date = {2024-12-03},
  url = {https://utkuturk.github.io/digital-castle/posts/welcome/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-o'malley2024" class="csl-entry quarto-appendix-citeas">
O’Malley, Tristan. 2024. <span>“Welcome To My Blog.”</span> December 3,
2024. <a href="https://utkuturk.github.io/digital-castle/posts/welcome/">https://utkuturk.github.io/digital-castle/posts/welcome/</a>.
</div></div></section></div> ]]></description>
  <category>news</category>
  <guid>https://utkuturk.github.io/digital-castle/posts/welcome/</guid>
  <pubDate>Tue, 03 Dec 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Guidelines to Run Montreal Forced Aligner for a PCIbex Experiment</title>
  <dc:creator>Utku Turk</dc:creator>
  <link>https://utkuturk.github.io/digital-castle/posts/mfa/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>We have our data from PCIbex and our zip files from the server. Let’s assume we have unzipped them and converted them from <code>.webm</code> to <code>.wav</code> files. Now, it’s time to align them using MFA. But before that, we need to prepare our files accordingly. Here are the steps we will follow in this document:</p>
<ul>
<li>Load the PCIbex results</li>
<li>Filter out irrelevant sound files</li>
<li>Move all of our <code>.wav</code> and <code>.TextGrid</code> files to the same directory</li>
<li>Rename our files according to MFA guidelines</li>
<li>Run MFA</li>
<li>Create a dataframe</li>
</ul>
<p>Before we start, let me load my favorite packages. The <code>library()</code> function loads the packages we need, assuming they are already installed. If not, use the <code>install.packages()</code> function to install them. While <code>library()</code> does not require quotes, you should use quotes with <code>install.packages()</code>, e.g., <code>install.packages("tidyverse")</code>. If it asks you to select a mirror from a list, choose a location geographically close to you, such as the UK.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I have to have tidyverse</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to manipulate string</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readtextgrid) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to read TextGrid files</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span></code></pre></div>
</div>
</section>
<section id="pcibex-results" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> PCIbex Results</h1>
<section id="read-the-results" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="read-the-results"><span class="header-section-number">2.1</span> Read the results</h2>
<p>The main reason we are loading PCIbex results is because sometimes we use the <code>async()</code> function in our PCIbex code. The <code>async()</code> function allows us to send recordings to our server whenever we want without waiting for the end of the experiment. Even though it is extremely helpful in reducing some of the server-PCIbex connection load at the end of the experiment, it also creates some pesky situations. For example, if a participant decides not to complete their experiment, we will still end up with some of their recordings. We do not want participants who were window-shopping, mainly because we are not sure about the quality of their data. Luckily for us, PCIbex only saves the results of participants who complete the entire experiment.</p>
<p>To read the PCIbex results, we are going to use the function provided in the <a href="https://doc.pcibex.net/advanced-tutorial/12_examining-data.html">PCIbex documentation</a>. Scroll down on that page, and you will see the words “Click for Base R Version.” The function is provided there as well. Moreover, please be careful whenever you are copying and pasting functions from this file, or any file, as sometimes PDF or HTML files can include unwanted elements, like a page number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># User-defined function to read in PCIbex Farm results files</span></span>
<span id="cb2-2">read.pcibex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb2-3">    filepath, </span>
<span id="cb2-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auto.colnames=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb2-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.col=</span>\(col,cols){cols[cols<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>col]<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(col,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ibex"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>);<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(cols)}</span>
<span id="cb2-6">    ) {</span>
<span id="cb2-7">  n.cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count.fields</span>(filepath,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (auto.colnames){</span>
<span id="cb2-9">    cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb2-10">    con <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file</span>(filepath, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>)</span>
<span id="cb2-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> ( <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> ) {</span>
<span id="cb2-12">      line <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readLines</span>(con, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warn=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb2-13">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(line) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb2-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-15">      }</span>
<span id="cb2-16">      m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(line,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexec</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^# (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">. (.+)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.$"</span>,line))[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb2-17">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(m) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb2-18">        index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-19">        value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb2-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.function</span>(fun.col)){</span>
<span id="cb2-21">         cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fun.col</span>(value,cols)</span>
<span id="cb2-22">        }</span>
<span id="cb2-23">        cols[index] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> value</span>
<span id="cb2-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n.cols){</span>
<span id="cb2-25">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-26">        }</span>
<span id="cb2-27">      }</span>
<span id="cb2-28">    }</span>
<span id="cb2-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">close</span>(con)</span>
<span id="cb2-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(filepath, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment.char=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names=</span>cols))</span>
<span id="cb2-31">  }</span>
<span id="cb2-32">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>{</span>
<span id="cb2-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(filepath, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment.char=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n.cols)))</span>
<span id="cb2-34">  }</span>
<span id="cb2-35">}</span></code></pre></div>
</div>
<p>So, now what we have to do is load our file. I also want to check my file using the <code>str()</code> function. Please run <code>?str</code> to see what this function does. For any function that you do not understand, you can run the <code>?</code> operator to see the help pages and some examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">ibex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.pcibex</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./octo-recall-ibex.csv"</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(ibex)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   15265 obs. of  23 variables:
 $ Results.reception.time              : int  1716599254 1716599254 1716599254 1716599254 1716599254 1716599254 1716599254 1716599254 1716599254 1716599254 ...
 $ MD5.hash.of.participant.s.IP.address: chr  "eb9865e3e6ad96f9ff9db3a12b5565ae" "eb9865e3e6ad96f9ff9db3a12b5565ae" "eb9865e3e6ad96f9ff9db3a12b5565ae" "eb9865e3e6ad96f9ff9db3a12b5565ae" ...
 $ Controller.name                     : chr  "PennController" "PennController" "PennController" "PennController" ...
 $ Order.number.of.item                : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Inner.element.number                : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Label                               : chr  "consent_form" "consent_form" "consent_form" "consent_form" ...
 $ Latin.Square.Group                  : chr  "NULL" "NULL" "NULL" "NULL" ...
 $ PennElementType                     : chr  "PennController" "PennController" "PennController" "Html" ...
 $ PennElementName                     : chr  "0" "0" "0" "consent" ...
 $ Parameter                           : chr  "_Trial_" "_Header_" "_Header_" "prolificID" ...
 $ Value                               : chr  "Start" "Start" "End" "66481a6d648519a547aebd68" ...
 $ EventTime                           : chr  "1716597822554" "1716597822554" "1716597822554" "1716597873803" ...
 $ w4                                  : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ w3                                  : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ w2                                  : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ w1                                  : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ nw                                  : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ itemnum                             : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ trigger_type                        : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ trigger                             : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ verb_type                           : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ head                                : chr  "undefined" "undefined" "undefined" "undefined" ...
 $ Comments                            : chr  "NULL" "NULL" "NULL" "text input" ...</code></pre>
</div>
</div>
<p>Now, what I want to do is to get to filenames that are recorded in the PCIbex results. Before doing that, I advise you to go to <a href="https://github.com/addrummond/ibex/blob/master/docs/manual.md">this documentation</a> and read more about PCIbex under the Basic Concepts header.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Column</strong></th>
<th style="text-align: left;"><strong>Information</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Time results were received (seconds since Jan 1 1970)</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">MD5 hash identifying subject. This is based on the subject’s IP address and various properties of their browser. Together with the value of the first column, this value should uniquely identify each subject.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Name of the controller for the entity (e.g.&nbsp;“DashedSentence”)</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Item number</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Element number</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Label. Label of the newTrial()</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Latin.Square.Group. The group they are assigned to.</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">PennElementType. Name of the specific element, like “Html”, “MediaRecorder”</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">PennElementName. Name we have given to the specific Penn Elements.</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Parameter. This is about what type of element the script is running and saving as a parameter.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">Value. Value saved for the parameters in column 10.</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">EventTime. Time that specific Element is screened or any action taken with that Element (seconds since Jan 1 1970)</td>
</tr>
</tbody>
</table>
</section>
<section id="filter-the-results" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="filter-the-results"><span class="header-section-number">2.2</span> Filter the results</h2>
<p>Since we are dealing with media recordings, I will first filter the file using the <code>PennElementType</code> column and will only select rows with “MediaRecorder” values in that column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">ibex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ibex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(PennElementType <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MediaRecorder"</span>)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(ibex<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Value)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "test-recorder.webm" "1_prac-1_jztb.webm" "2_prac-1_jztb.webm"</code></pre>
</div>
</div>
<p>After checking my <code>Value</code> column where the file names for <code>MediaRecorder</code> are stored, I realize that this will not be enough given that we still have other unwanted elements like <code>test-recorder.webm</code> file or some practice files. There are multiple ways to get rid of these files, and you have to think about how to get rid of them for your own specific dataframe. For my own data, I will filter my data utilizing the labels I provided in my PCIbex code. They are stored in the <code>Labels</code> column. What I want is to only get the <code>MediaRecorders</code> that are within a trial whose label starts with the word <code>trial</code>.</p>
<p>You may have coded your data differently; you may have used a different word; you may not even have any practice or test-recorders, so maybe you do not even need this second filtering. Check your dataframe using the <code>View()</code> function. I am also using a function called <code>str_detect()</code>, which detects a regular expression pattern, in this case <code>^trial</code>, meaning starting with the word trial. Now, when I check my dataframe, I will only see experimental trials and recordings related to those trials. Just to make sure, I am also using the <code>unique()</code> function so that I do not have repetitions. And, I am assigning my filenames to a list called <code>ibex_files</code>. You can see that any random sample with the <code>sample()</code> function will give filenames related to experimental trials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">ibex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ibex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(Label, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^trial"</span>))</span>
<span id="cb7-2">ibex_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ibex<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(ibex_files, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dog_Unergative_unrelated_soaw.webm"  
[2] "snail_Unergative_unrelated_tvbh.webm"
[3] "chef_Unergative_related_uopp.webm"   </code></pre>
</div>
</div>
</section>
<section id="operators-used-in-this-section" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="operators-used-in-this-section"><span class="header-section-number">2.3</span> Operators used in this section</h2>
<div class="function">
<p><code>?</code></p>
<p>Opens the help page for any function.</p>
<p>example use: <code>?library()</code></p>
</div>
<br>
<div class="function">
<p><code>==</code></p>
<p>Test for equality. <strong>Don’t confuse with a single =, which is an assignment operator (and also always returns TRUE).</strong></p>
<p>example use: ``</p>
</div>
<p><br></p>
<div class="function">
<p><code>|&gt;</code></p>
<p><em>(Forward) pipe:</em> Use the expression on the left as a part of the expression on the right.</p>
<ul>
<li>Read <code>x |&gt; fn()</code> as <em>‘use <code>x</code> as the <strong>only</strong> argument of function <code>fn</code>’.</em></li>
<li>Read <code>x |&gt; fn(1, 2)</code> as <em>‘use <code>x</code> as the <strong>first</strong> argument of function <code>fn</code>’.</em></li>
<li>Read <code>x |&gt; fn(1, ., 2)</code> as <em>‘use <code>x</code> as the <strong>second</strong> argument of function <code>fn</code>’.</em></li>
</ul>
<p>example use: ``</p>
</div>
</section>
<section id="our-task-list" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="our-task-list"><span class="header-section-number">2.4</span> Our Task List</h2>
<ul>
<li><del>Load the PCIbex results</del></li>
<li>Filter irrelevant sound files</li>
<li>Move all of our <code>.wav</code> and <code>.TextGrid</code> files to the same directory</li>
<li>Rename our files according to MFA guidelines</li>
<li>Run MFA</li>
<li>Create a dataframe</li>
</ul>
</section>
</section>
<section id="filtering-files-from-the-server" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Filtering Files from the Server</h1>
<p>Now that we have a <em>gold list</em>, we can go ahead and filter our files from the server according to our gold list, based on the results from PCIbex. To do this, first we will create a temporary folder called <code>gold</code>. We will strip every file name of its extension <code>.wav</code> or <code>.TextGrid</code> and check if that name exists in our <em>gold list</em>. If that is the case, we will move the file. To this end, we are going to use something called <a href="https://www.youtube.com/watch?v=5zOTJ0fOllI"><em>for loops</em></a> and <a href="https://www.youtube.com/watch?v=N6E_qqhwr7M"><em>if statements</em></a>. You can click on the hyperlinks to watch more on them. <sup>1</sup></p>
<ul>
<li>First, we need to list all of our files. I have all my <code>.wav</code> and <code>.TextGrid</code> files in the same place, so I just need to list a single directory. You might have them in different places. Check the commented-out part. To only get relevant files, I am using a regular expression saying only choose the ones that end (<code>$</code>) with <code>.wav</code> or (<code>|</code>) <code>.TextGrid</code> using the pattern argument.</li>
<li>Second, we create our <em>gold directory</em> with the <code>dir.create()</code> function.</li>
<li>Third, we iterate over every file in the files list, get its name without its extension using the <code>tools::file_path_sans_ext()</code> function and check whether it exists in our <em>gold list</em> using the <code>%in%</code> operator.</li>
<li>If it is also present in the gold list, we specify where the file exists and assign it to a variable called <code>old_file_path</code>. We also specify where it should be moved and assign it to a variable called <code>new_file_path</code>. We use the <code>file.path()</code> function and <code>dir</code>/<code>gold_dir</code> variables, along with the file <code>f</code> we are iterating over.</li>
<li>Lastly, we move the file using the <code>file.rename()</code> function. Even though the name of the function is <em>rename</em>, it can be used to move files. Every file exists with its pointer, such as <code>~/data/important.R</code>. By changing this pointer, we can change its name, as well as its location to something like <code>~/gold_data/really_important.R</code>. We did not only change the file name from important to really_important. We also changed other parts of this pointer, that is the folder part. If the folder <code>gold_data</code> exists, it will be moved there.</li>
<li>To make sure this for loop works, I also print a message after every file movement using the <code>cat()</code> function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data"</span></span>
<span id="cb9-2">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use these lines if you have sound and transcriptions in different places.</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wav_dir &lt;- "~/wav_data"</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tg_dir &lt;- "~/tg_data"</span></span>
<span id="cb9-6"></span>
<span id="cb9-7">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid"</span>)</span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use these lines if you have sound and transcriptions in different places.</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tg_files &lt;- list.files(wav_dir, pattern = "\\.wav$|\\.TextGrid")</span></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wav_files &lt;- list.files(tg_dir, pattern = "\\.wav$|\\.TextGrid")</span></span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(gold_dir)</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> files) {</span>
<span id="cb9-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(ibex_files)) {</span>
<span id="cb9-16">    old_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(dir, f)</span>
<span id="cb9-17">    new_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, f)</span>
<span id="cb9-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(old_file_path, new_file_path)</span>
<span id="cb9-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moved "</span>, f, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" to "</span>, new_file_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-20">  }</span>
<span id="cb9-21">}</span></code></pre></div>
</div>
<p>One important thing to note here is that if you have your <code>.wav</code> and <code>.TextGrid</code> files in different directories, you can either manually move them to a single folder using your file management application. Alternatively, you can run the commands above using <code>wav_dir</code> and <code>tg_dir</code> variables, along with <code>tg_files</code> and <code>wav_files</code> variables. It should look like the following. There are, of course, better ways to solve this problem, and I leave that to your creativity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">wav_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/wav_data"</span></span>
<span id="cb10-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/tg_data"</span></span>
<span id="cb10-3">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb10-4"></span>
<span id="cb10-5"></span>
<span id="cb10-6">tg_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(wav_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid"</span>)</span>
<span id="cb10-7">wav_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(tg_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid"</span>)</span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(gold_dir)</span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tg_files) {</span>
<span id="cb10-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(ibex_files)) {</span>
<span id="cb10-13">    old_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(tg_dir, f)</span>
<span id="cb10-14">    new_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, f)</span>
<span id="cb10-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(old_file_path, new_file_path)</span>
<span id="cb10-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moved"</span>, f, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span>, new_file_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-17">  }</span>
<span id="cb10-18">}</span>
<span id="cb10-19"></span>
<span id="cb10-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> wav_files) {</span>
<span id="cb10-21">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(ibex_files)) {</span>
<span id="cb10-22">    old_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(wav_dir, f)</span>
<span id="cb10-23">    new_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, f)</span>
<span id="cb10-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(old_file_path, new_file_path)</span>
<span id="cb10-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moved"</span>, f, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span>, new_file_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-26">  }</span>
<span id="cb10-27">}</span></code></pre></div>
</div>
<section id="operators-used-in-this-section-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="operators-used-in-this-section-1"><span class="header-section-number">3.1</span> Operators used in this section</h2>
<div class="function">
<p><code>%in%</code></p>
<p>Test for membership</p>
<p>example use: ``</p>
</div>
</section>
<section id="our-task-list-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="our-task-list-1"><span class="header-section-number">3.2</span> Our Task List</h2>
<ul>
<li><del>Load the PCIbex results</del></li>
<li><del>Filter irrelevant sound files</del></li>
<li><del>Move all of our .wav and .TextGrid files to the same directory</del></li>
<li>Rename our files according to MFA guidelines</li>
<li>Run MFA</li>
<li>Create a dataframe</li>
</ul>
</section>
</section>
<section id="renaming-files" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Renaming Files</h1>
<p>This section is going to be the section you have to be most careful about. If you mess anything up in this section, you will have to delete everything, go back, unzip your files, convert them to <code>.wav</code> from <code>.webm</code>, and do everything in this file again. So, before giving you the for-loop to rename all files, I want to make sure that we go over one of the files and make sure we do it correctly.</p>
<p>The main reason we rename our files is because we want Montreal Forced Aligner to understand that we have multiple speakers in our dataset. If we do not do that, it will treat all files as if they are from a single speaker and probably will be very confused due to inter-speaker variance in speech. Since we have erroneously specified in our PCIbex files to use the <code>subject_id</code> as a suffix rather than a prefix, we have to fix that. If in the future we fix that in our PCIbex script, we do not have to go over this part.</p>
<section id="one-file-example" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="one-file-example"><span class="header-section-number">4.1</span> One-file example</h2>
<p>My files, after unzipping, converting to <code>.wav</code>, and filtering according to the gold list, look like the following. There are some important things to keep in mind here. First of all, now that everything is in our <em>gold directory</em>, we have to use the <code>gold_dir</code> variable to list our files. Secondly, we again need to use the pattern argument to make sure we only select relevant files. The last thing to be aware of in the next code is that I am using indexing with square brackets to refer to the first elements in the list. I will use this element to first ensure that what I am doing is correct.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb11-2">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(gold_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb11-3">example_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> files[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb11-4">example_file</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "shota-rep-trial_ballerinaUnacc_sgsg_related_dltc.TextGrid"</code></pre>
</div>
</div>
<section id="get-the-extension-and-the-name" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="get-the-extension-and-the-name"><span class="header-section-number">4.1.1</span> Get the extension and the name</h3>
<p>Now that we have the name of an example file, we can start by extracting its extension. We will use the function <code>file_ext</code> from the package called <code>tools</code>. Sometimes, we do not want to load an entire package, but we want to access a single function. In those cases, we use the operator <code>::</code>. Additionally, we will use <code>paste0</code> to prefix the extension with a dot, so that we can use it later when we rename our files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_ext</span>(example_file)</span>
<span id="cb13-2">extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>, extension)</span>
<span id="cb13-3">extension</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ".TextGrid"</code></pre>
</div>
</div>
<p>As for the rest of the name, we will use the <code>file_path_sans_ext()</code> function that we used earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">rest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(example_file)</span>
<span id="cb15-2">rest</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "shota-rep-trial_ballerinaUnacc_sgsg_related_dltc"</code></pre>
</div>
</div>
</section>
<section id="get-the-subject-id" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="get-the-subject-id"><span class="header-section-number">4.1.2</span> Get the subject id</h3>
<p>Now, the most important part is getting the subject name. If you look at what my <code>rest</code> variable returned, you can see that it consists of the last 4 characters, which are also the last set of characters after the last underscore. There are multiple ways to extract the subject id. I will show you both methods so that you can choose and adapt them for your own data. For the underscore version, we will use the function <code>str_split()</code>, and for the character counting, we will use <code>str_sub()</code>.</p>
<section id="underscore-approach" class="level4" data-number="4.1.2.1">
<h4 data-number="4.1.2.1" class="anchored" data-anchor-id="underscore-approach"><span class="header-section-number">4.1.2.1</span> Underscore approach</h4>
<p><code>str_split()</code> takes a string and splits it according to the separator you provide. In our case, the separator is the underscore. We are also using an additional argument called <code>simplify</code> to make the resulting elements more user-friendly. Our function now returns a small table with 1 row and 5 columns. To select the values in the 5th column, we use square brackets again, this time with a comma. When you apply this approach to your own data, remember that you may end up with fewer or more than 5 columns depending on your naming convention. Be sure to adjust the column number accordingly. It might also be the case that your subject id is not stored last or that your separators are not underscores but simple “-”. Modify the code according to your specific needs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using the underscore information</span></span>
<span id="cb17-2">subj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(rest, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-3">subj</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]              [,2]             [,3]   [,4]      [,5]  
[1,] "shota-rep-trial" "ballerinaUnacc" "sgsg" "related" "dltc"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">subj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> subj[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb19-2">subj</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dltc"</code></pre>
</div>
</div>
<p>Lastly, we have to modify the <code>rest</code> variable so that we do not include the subject id twice. I will use the same approach again. After obtaining the table, I will use the <code>paste()</code> function to concatenate the columns back together with the underscore separator. Adjust the number of columns used in this function and the separator according to your own data needs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">nosubj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(rest, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-2">nosubj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(nosubj[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], nosubj[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], nosubj[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], nosubj[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>)</span>
<span id="cb21-3">nosubj</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "shota-rep-trial_ballerinaUnacc_sgsg_related"</code></pre>
</div>
</div>
</section>
<section id="character-approach" class="level4" data-number="4.1.2.2">
<h4 data-number="4.1.2.2" class="anchored" data-anchor-id="character-approach"><span class="header-section-number">4.1.2.2</span> Character approach</h4>
<p><code>str_sub()</code> allows you to extract a substring using indices. In my case, the subject id is the last four characters. To refer to characters from the end, you can use the minus symbol <code>-</code>. I specify <code>-4</code> in the <code>start</code> argument, which means I want to extract the string starting from the fourth character counting back from the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">subj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb23-2">subj</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dltc"</code></pre>
</div>
</div>
<p>To get the rest of the filename, I specify the starting point as <code>1</code> and the endpoint as <code>-6</code>. Using <code>-5</code> would include the underscore as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">nosubj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb25-2">nosubj</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "shota-rep-trial_ballerinaUnacc_sgsg_related"</code></pre>
</div>
</div>
</section>
</section>
<section id="put-the-new-name-and-the-path-together" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="put-the-new-name-and-the-path-together"><span class="header-section-number">4.1.3</span> Put the new name and the path together</h3>
<p>At this point, we have everything we need: (i) the subject id prefix, (ii) the rest of our file name, and (iii) the extension. Now, we need to combine all of this together. We are going to use the <code>paste0()</code> function. Remember, this function is different from <code>paste()</code>. The main difference is that with <code>paste0()</code>, we cannot specify separators; we have to provide everything. This might seem like a disadvantage at first, but it is beneficial for non-pattern cases like this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">new_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(subj, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, nosubj, extension)</span>
<span id="cb27-2">new_name</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dltc_shota-rep-trial_ballerinaUnacc_sgsg_related.TextGrid"</code></pre>
</div>
</div>
<p>We also need to create a new path to rename our file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">new_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, new_name)</span>
<span id="cb29-2">new_path</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "~/data/gold/dltc_shota-rep-trial_ballerinaUnacc_sgsg_related.TextGrid"</code></pre>
</div>
</div>
</section>
<section id="rename-the-file" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="rename-the-file"><span class="header-section-number">4.1.4</span> Rename the file</h3>
<p>We will once again use the <code>file.rename()</code> function. This time, we are only changing the file name and not the path, so the file will remain in its current location. We also need to obtain the full path of our <code>example_file</code>. We can achieve this easily using the <code>file.path</code> function again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">example_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, example_file)</span>
<span id="cb31-2">example_file_path</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "~/data/gold/shota-rep-trial_ballerinaUnacc_sgsg_related_dltc.TextGrid"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(example_file_path, new_path)</span></code></pre></div>
</div>
<p>After running this, make sure the naming convention is as we want. Check your folder by searching for the trial. It should look something like <code>subj_rest.wav</code> or <code>subj_rest.TextGrid</code>. In my case, it is <code>dltc_shota-rep-trial_ballerinaUnacc_sgsg_related.TextGrid</code>, where <code>dltc</code> is my subject id or subj.</p>
</section>
</section>
<section id="little-treat-for-you" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="little-treat-for-you"><span class="header-section-number">4.2</span> Little treat for you</h2>
<p>I know that some of your files look like the following: <code>squid_S_jtfr.wav</code>. Here, I will provide you with the code to rename this. Please check this code before using it. First, let’s arbitrarily assign this name to a variable. Remember, in your case, you will obtain this from your <code>files</code> list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1">example_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"squid_S_jtfr.wav"</span></span></code></pre></div>
</div>
<p>Now, I am going to put all the code together in one chunk, except for moving. Also, be aware that I am using my own <code>gold_dir</code>; please specify yours according to your needs. Additionally, be mindful of your operating system (Windows or Mac). If you are using Windows, your <code>gold_dir</code> variable should look like the second line. I have commented out that part with a hashtag/pound symbol. Uncomment it by deleting the first pound symbol.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb35-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gold_dir &lt;- "C:/Users/utkuturk/data/gold" # for windows</span></span>
<span id="cb35-3">extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_ext</span>(example_file)</span>
<span id="cb35-4">extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>, extension)</span>
<span id="cb35-5">rest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(example_file)</span>
<span id="cb35-6">subj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb35-7">nosubj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb35-8">new_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(subj, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, nosubj, extension)</span>
<span id="cb35-9">new_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, new_name)</span>
<span id="cb35-10">new_path</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "~/data/gold/jtfr_squid_S.wav"</code></pre>
</div>
</div>
<p>This would be your original example file path.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">example_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, example_file)</span>
<span id="cb37-2">example_file_path</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "~/data/gold/squid_S_jtfr.wav"</code></pre>
</div>
</div>
<p>And this line would handle the renaming from the old <code>example_file_path</code> to the <code>new_path</code>, thereby assigning the new name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(example_file_path, new_path)</span></code></pre></div>
</div>
</section>
<section id="for-loop" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="for-loop"><span class="header-section-number">4.3</span> For loop</h2>
<p>If you have ensured that the code above works correctly for you, you are now ready to implement the for loop. Within the loop, define a variable like <code>f</code> and use it instead of <code>example_file</code>. This way, you will iterate over every file in your list. To verify that it is functioning correctly, I also added a line to print a message each time a file is renamed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb40-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gold_dir &lt;- "C:/Users/utkuturk/data/gold" # for windows</span></span>
<span id="cb40-3">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(gold_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb40-4"></span>
<span id="cb40-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> files) {</span>
<span id="cb40-6">  extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_ext</span>(f)</span>
<span id="cb40-7">  extension <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>, extension)</span>
<span id="cb40-8">  rest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(f)</span>
<span id="cb40-9">  subj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb40-10">  nosubj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(rest, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb40-11">  new_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(subj, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, nosubj, extension)</span>
<span id="cb40-12">  new_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, new_name)</span>
<span id="cb40-13">  file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, f)</span>
<span id="cb40-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(file_path, new_path)</span>
<span id="cb40-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Renamed"</span>, f, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span>, new_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb40-16">}</span></code></pre></div>
</div>
</section>
<section id="operators-used-in-this-section-2" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="operators-used-in-this-section-2"><span class="header-section-number">4.4</span> Operators used in this section</h2>
<div class="function">
<p><code>df[selected_rows, indices_columns] or list[selected_element]</code></p>
<p><em>[], Indexing operator:</em> Accesses specific rows and/or columns of a data frame. If it is a list, it only takes a single argument to select an element. Remember in R indices start with 1, unlike python.</p>
<ul>
<li><code>selected_rows</code> A vector of indices or names.</li>
<li><code>selected_columns</code> A vector of indices or names.</li>
<li><code>selected_element</code> A vector of indices or names.</li>
</ul>
<p>example use: <code>files[1]</code></p>
</div>
<p><br></p>
<div class="function">
<p><code>::</code></p>
<p><em>Double colon operator:</em> Accesses functions and other objects from packages. Read <code>x::y</code> as <em>‘function y from package x.’</em></p>
<p>example use: <code>tools::file_ext()</code></p>
</div>
</section>
<section id="our-task-list-2" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="our-task-list-2"><span class="header-section-number">4.5</span> Our Task List</h2>
<ul>
<li><del>Load the PCIbex results</del></li>
<li><del>Filter irrelevant sound files</del></li>
<li><del>Move all of our .wav and .TextGrid files to the same directory</del></li>
<li><del>Rename our files according to MFA guidelines</del></li>
<li>Run MFA</li>
<li>Create a dataset</li>
</ul>
</section>
</section>
<section id="running-the-montreal-forced-aligner" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Running the Montreal Forced Aligner</h1>
<p>Now that we have our files in the format we want, we can place all of our files in the MFA folder and start running the aligner. We can either move our files using the Explorer app and usual copy-paste or we can use the <code>file.rename()</code> function again. Due to the aligner’s limitations, the second option is far better. The main constraint is that MFA starts encountering problems when we feed it more than 2000 files at once. Since I have a lot of data, I will use the following function to divide my files and move them into smaller subfolders. But before that, I will show you how to move files without dividing them into subfolders.</p>
<section id="moving-the-files-to-mfa-directory" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="moving-the-files-to-mfa-directory"><span class="header-section-number">5.1</span> Moving the Files to MFA Directory</h2>
<section id="without-dividing" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="without-dividing"><span class="header-section-number">5.1.1</span> Without Dividing</h3>
<p>Again, we are going to use the <code>file.rename()</code> and <code>dir.create()</code> functions to create the directory we are moving files to, and of course, to move files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gold directory, where all of our files are</span></span>
<span id="cb41-2">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb41-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MFA directory</span></span>
<span id="cb41-4">mfa_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/mycorpus"</span></span>
<span id="cb41-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(mfa_dir)</span>
<span id="cb41-6"></span>
<span id="cb41-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Files </span></span>
<span id="cb41-8">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(gold_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb41-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> files) {</span>
<span id="cb41-10">  old_file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(gold_dir, f)</span>
<span id="cb41-11">  mfa_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(mfa_dir, f)</span>
<span id="cb41-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(old_file_path, mfa_path)</span>
<span id="cb41-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moved"</span>, f, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span>, mfa_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb41-14">}</span></code></pre></div>
</div>
</section>
<section id="with-dividing-them-into-subfolders" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="with-dividing-them-into-subfolders"><span class="header-section-number">5.1.2</span> With Dividing them into subfolders</h3>
<p>I will introduce the following function that I use. Here, I will not go into details, but it basically performs the following steps:</p>
<ul>
<li>Creates a subfolder called <code>s1</code> and moves files into it.</li>
<li>Counts up to 2000.</li>
<li>When it surpasses 2000, it creates another subfolder by incrementing the number from <code>s1</code> to <code>s2</code>.</li>
<li>Continues this process until there are no more files.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">divide_and_move <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(source, target, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limit=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>) {</span>
<span id="cb42-2">  files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(source, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.wav$|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb42-3">  base_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_path_sans_ext</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(files)))</span>
<span id="cb42-4">  s_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb42-5">  f_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-6">  s_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(target, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>, s_index))</span>
<span id="cb42-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(s_path)</span>
<span id="cb42-8">  </span>
<span id="cb42-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (b <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> base_names) {</span>
<span id="cb42-10">    rel_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> files[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^"</span>, b, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(files))]</span>
<span id="cb42-11">    </span>
<span id="cb42-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (f_index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(rel_files) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> limit) {</span>
<span id="cb42-13">      s_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s_index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb42-14">      s_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(target, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>, s_index))</span>
<span id="cb42-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(s_path)</span>
<span id="cb42-16">      f_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-17">    }</span>
<span id="cb42-18">    </span>
<span id="cb42-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rel_files) {</span>
<span id="cb42-20">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.rename</span>(f, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(s_path, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(f)))</span>
<span id="cb42-21">    }</span>
<span id="cb42-22">    f_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> f_index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(rel_files)</span>
<span id="cb42-23">  }</span>
<span id="cb42-24">}</span></code></pre></div>
</div>
<p>You can use this function by simply providing the source and target folders.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gold directory, where all of our files are</span></span>
<span id="cb43-2">gold_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data/gold"</span></span>
<span id="cb43-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MFA directory</span></span>
<span id="cb43-4">mfa_main_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA"</span></span>
<span id="cb43-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(mfa_dir)</span>
<span id="cb43-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">divide_and_move</span>(gold_dir, mfa_main_dir)</span></code></pre></div>
</div>
</section>
</section>
<section id="terminal-codes" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="terminal-codes"><span class="header-section-number">5.2</span> Terminal Codes</h2>
<p>After moving the files either with code or by hand to a specific MFA folder, <code>~/Documents/MFA</code>, we can start running the terminal commands. At this point, I assume you have gone through the <a href="https://montreal-forced-aligner.readthedocs.io/en/latest/installation.html">MFA documentation</a> for installation instructions. I am also assuming that you have used a <code>conda</code> environment. If you haven’t, here are the 3 lines to install MFA.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Conda Installation in Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate base</span>
<span id="cb44-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge mamba</span>
<span id="cb44-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> aligner <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge montreal-forced-aligner</span></code></pre></div>
</div>
</div>
<p>There are again two ways to do this. One way is to open your Terminal app or use the Terminal tab in the R console below. The other way, which I prefer more, is to execute commands using the R function <code>system()</code>. I will first go over the easier one, which is using the Terminal app or the Terminal tab in R. But the reason I prefer the <code>system()</code> function is that I can loop over multiple folders more easily that way, and I do not have to run my commands again and again.</p>
<section id="using-terminal" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="using-terminal"><span class="header-section-number">5.2.1</span> Using Terminal</h3>
<p>The first command we want to run is the conda environment code. Following the MFA documentation, I renamed my environment to <code>aligner</code>. So, I start by activating that environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate aligner</span></code></pre></div>
</div>
<p>After activating the environment, I need to download three models: (i) an acoustic model to recognize phonemes given previous and following acoustic features, (ii) a dictionary to access pretrained phone-word mappings, and (iii) a g2p model to generate sequences of phones based on orthography. For all of these models, we are going to use the <code>english_us_arpa</code> model. You can visit <a href="https://mfa-models.readthedocs.io/en/latest/acoustic/index.html">this website</a> to explore various languages and models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> model download acoustic english_us_arpa</span>
<span id="cb46-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> model download dictionary english_us_arpa</span>
<span id="cb46-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> model download g2p english_us_arpa</span></code></pre></div>
</div>
<p>After downloading these models, we are going to validate our corpus. There are many customizable parameters for this step. You can check them <a href="https://montreal-forced-aligner.readthedocs.io/en/latest/user_guide/data_validation.html">here</a>. I am going to use my favorite settings here. You can interpret the following command like this: <em>Dear Montreal Forced Aligner (<code>mfa</code>), can you please analyze my files located in <code>~/Documents/MFA/mycorpus</code> and <code>validate</code> them using the <code>english_us_arpa</code> acoustic model and <code>english_us_arpa</code> dictionary? Please also consider that I have multiple speakers, indicated by the first 4 characters (<code>-s 4</code>). It would be great to use multiprocessing (<code>--use_mp</code>) for faster execution. Lastly, please clean up previous and new temporary files (<code>--clean --final_clean</code>).</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> validate <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use_mp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clean</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--final_clean</span> ~/Documents/MFA/mycorpus english_us_arpa english_us_arpa</span></code></pre></div>
</div>
<p>This process will take some time. Afterward, you will have some <em>out of vocabulary</em> words found in your TextGrids. You can easily create new pronunciations for them and add them to your model.</p>
<p>The <code>mfa g2p</code> command can take many arguments; here I am using only three. First, the path to the text file that has <em>out of vocabulary</em> words. This file is automatically created in your folder where your files are located. The path may vary depending on your system and folder naming, but the name of the <code>.txt</code> file will be the same. In my case, it is <code>~/Documents/MFA/mycorpus/oovs_found_english_us_arpa.txt</code>. The second argument is the name of the g2p model. As you may recall, we downloaded it earlier, and its name is <code>english_us_arpa</code>. Finally, the third argument is the path to a target <code>.txt</code> file to store new pronunciations. I would like to store them in the same place, so I am using the following path: <code>~/Documents/MFA/mycorpus/g2pped_oovs.txt</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> g2p ~/Documents/MFA/mycorpus/oovs_found_english_us_arpa.txt english_us_arpa ~/Documents/MFA/mycorpus/g2pped_oovs.txt</span></code></pre></div>
</div>
<p>After creating the pronunciations, you can add them to your model with <code>mfa model add_words</code>. This command takes the name of the dictionary as an argument (<code>english_us_arpa</code>) and the output of the <code>mfa g2p</code> command, which was a <code>.txt</code> file storing pronunciations: <code>~/Documents/MFA/mycorpus/g2pped_oovs.txt</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> model add_words english_us_arpa ~/Documents/MFA/mycorpus/g2pped_oovs.txt</span></code></pre></div>
</div>
<p>The last step is the alignment process. It will align (<code>mfa align</code>) the words and the phones inside our TextGrids stored in <code>~/Documents/MFA/mycorpus</code> using our previously downloaded dictionary (<code>english_us_arpa</code>) and model (<code>english_us_arpa</code>), and store the newly aligned TextGrids in a new folder called <code>~/Documents/MFA/output</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mfa</span> align ~/Documents/MFA/mycorpus english_us_arpa english_us_arpa ~/Documents/MFA/output</span></code></pre></div>
</div>
</section>
<section id="using-r" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="using-r"><span class="header-section-number">5.2.2</span> Using R</h3>
<p>We can also accomplish all of this in R. One advantage of this approach is that it allows us to iterate over multiple subfolders more easily, which can be useful if we have more than 2000 files. We will use four components:</p>
<ol type="i">
<li><code>system()</code> function to execute terminal commands,</li>
<li><code>paste()</code> function to create multiline templates,</li>
<li><code>%s</code> string placeholder to create template codes,</li>
<li><code>sprintf()</code> function to format our templates.</li>
</ol>
<section id="introduction-to-sprintf-and-s" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="introduction-to-sprintf-and-s"><span class="header-section-number">5.2.2.1</span> Introduction to <code>sprintf()</code> and <code>%s</code></h4>
<p>Before going further with MFA codes, let me illustrate with an example. Suppose we have a list of folder names, and we want to create a <code>.txt</code> file in each of these folders. We can use the <code>system()</code> function to perform this action. Below, I define my <code>folder_list</code>, then create paths for my <code>.txt</code> files in each folder, such as <code>~/data1/mydocument.txt</code>. Afterwards, I generate a list of commands to create these files using <code>touch</code>, which is a command-line tool for creating files. Finally, I execute these commands using the <code>system()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1">folder_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data3"</span>)</span>
<span id="cb51-2"></span>
<span id="cb51-3"></span>
<span id="cb51-4">txt_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(folder_list, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mydocument.txt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb51-5">txt_list</span>
<span id="cb51-6">command_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"touch"</span>, txt_list, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb51-7">command_list</span>
<span id="cb51-8"></span>
<span id="cb51-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (command <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> command_list) {</span>
<span id="cb51-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(command)</span>
<span id="cb51-11">}</span></code></pre></div>
</div>
<p>Technically, we didn’t need to use a for loop; instead, we could have concatenated all these commands with <code>;</code> and run a single system command. Bash can execute multiple commands in a single line when separated by <code>;</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">concatenated_commands <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(command_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb52-2">                               command_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb52-3">                               command_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], </span>
<span id="cb52-4">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>) </span>
<span id="cb52-5"></span>
<span id="cb52-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(concatenated_commands)</span></code></pre></div>
</div>
<p>We could achieve the same without needing a folder list by utilizing the <code>%s</code> placeholder and the <code>sprintf()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">command_template <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"touch %s/mydocument.txt"</span></span>
<span id="cb53-2">concatenated_commands <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data1"</span>), </span>
<span id="cb53-3">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data2"</span>),</span>
<span id="cb53-4">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data3"</span>),</span>
<span id="cb53-5">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb53-6"></span>
<span id="cb53-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(concatenated_commands)</span></code></pre></div>
</div>
<p>This approach becomes particularly useful when dealing with multiple placeholders within the same command. For instance, the command template will replace the first <code>%s</code> with the first argument, such as <code>~/data1</code>, and the second <code>%s</code> with the second argument, like <code>mydoc1</code>, when formatted using <code>sprintf()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">command_template <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"touch %s/%s.txt"</span></span>
<span id="cb54-2">concatenated_commands <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mydoc1"</span>), </span>
<span id="cb54-3">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mydoc2"</span>),</span>
<span id="cb54-4">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(command_template, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/data3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mydoc3"</span>),</span>
<span id="cb54-5">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb54-6"></span>
<span id="cb54-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(concatenated_commands)</span></code></pre></div>
</div>
</section>
<section id="running-mfa-in-r" class="level4" data-number="5.2.2.2">
<h4 data-number="5.2.2.2" class="anchored" data-anchor-id="running-mfa-in-r"><span class="header-section-number">5.2.2.2</span> Running MFA in R</h4>
<p>Next, we’ll consolidate the previous code by concatenating it using <code>paste()</code> and separating commands with <code>;</code>. If needed, we’ll incorporate placeholders. Each line will be assigned to a new variable, and then they’ll be combined into a single command string using <code>paste()</code>. Finally, we’ll execute the command string using <code>system()</code> with the argument <code>intern = TRUE</code> to capture the output into an R variable, which allows for later inspection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">conda_start <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conda activate aligner"</span></span>
<span id="cb55-2">get_ac <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa model download acoustic english_us_arpa"</span></span>
<span id="cb55-3">get_dic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa model download dictionary english_us_arpa"</span></span>
<span id="cb55-4">get_g2p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa model download g2p english_us_arpa"</span></span>
<span id="cb55-5"></span>
<span id="cb55-6">mfa_init <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(conda_start, get_ac, get_dic, get_g2p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb55-7"></span>
<span id="cb55-8">mfa_init_output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(mfa_init, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<p>After initializing the model, the next step involves validation. Again, I’ll use the same approach and concatenate the commands together. However, sometimes we may have too many files and need to use subfolders. To accommodate this, I’ll use <code>%s</code> placeholders. The validation command has one placeholder for different subfolders. Similarly, our pronunciation creation for g2p has two placeholders, though they’ll be filled with the same value. Lastly, the <code>add_words</code> command will use a single placeholder. Fortunately, all these folders are the same, so we can reuse the same variable repeatedly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">conda_start <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conda activate aligner"</span></span>
<span id="cb56-2"></span>
<span id="cb56-3">validate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa validate -s 4 --use_mp --clean --final_clean ~/Documents/MFA/%s english_us_arpa english_us_arpa"</span></span>
<span id="cb56-4">g2p_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa g2p ~/Documents/MFA/%s/oovs_found_english_us_arpa.txt english_us_arpa ~/Documents/MFA/%s/g2pped_oovs.txt"</span></span>
<span id="cb56-5">add_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa model add_words english_us_arpa ~/Documents/MFA/%s/g2pped_oovs.txt"</span></span>
<span id="cb56-6"></span>
<span id="cb56-7">mfa_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(conda_start, validate, g2p_words, add_words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span></code></pre></div>
</div>
<p>Since this step takes longer and there’s more room for errors, I want to save all my outputs in a list. First, I need to identify which folders exist in my MFA directory. Because my <code>divide_and_move</code> function prefixes every subfolder with <code>s</code>, I’ll use <code>^s</code> to filter for relevant folders.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1">output_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb57-2"></span>
<span id="cb57-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base path where folders are located</span></span>
<span id="cb57-4">base_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA"</span></span>
<span id="cb57-5">folders <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.dirs</span>(base_path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">recursive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb57-6">folders <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> folders[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(folders, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^s"</span>)]</span>
<span id="cb57-7"></span>
<span id="cb57-8">folders</span></code></pre></div>
</div>
<p>Now, we can iterate over this list of folders using a for loop. First, we create a temporary script using <code>sprintf()</code> with four placeholders. Next, we execute the current script and save the output in a <code>temp_output</code> variable. Later, we assign this output to specific <code>output_name</code> variables for each folder using <code>paste0()</code> and <code>assign()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> folders) {</span>
<span id="cb58-2">  cur_mfa_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(mfa_val, f, f, f, f)</span>
<span id="cb58-3">  </span>
<span id="cb58-4">  temp_output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(cur_mfa_val, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb58-5">  </span>
<span id="cb58-6">  output_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_val_"</span>, f)</span>
<span id="cb58-7">  </span>
<span id="cb58-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(output_name, temp_output, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">envir =</span> .GlobalEnv)</span>
<span id="cb58-9">}</span></code></pre></div>
</div>
<p>Now you can check the outputs by calling specific variables like <code>output_val_s1</code> or <code>output_val_s2</code>. After this step, the only task remaining is to run the aligner. We will create a template again, iterate over folders, and assign outputs to their respective names for verification. Meanwhile, the bash code will execute in the background. This time, our placeholders will refer to different inputs and an output folder. Fortunately, we can use the same output folder for every subfolder, so instead of using two placeholders, we’ll use a single <code>%s</code> placeholder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">conda_start <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conda activate aligner"</span></span>
<span id="cb59-2"></span>
<span id="cb59-3">align <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mfa align ~/Documents/MFA/%s english_us_arpa english_us_arpa ~/Documents/MFA/output"</span></span>
<span id="cb59-4"></span>
<span id="cb59-5">mfa_align <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(conda_start, align, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)</span>
<span id="cb59-6"></span>
<span id="cb59-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (f <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> folders) {</span>
<span id="cb59-8">  cur_mfa_align <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(mfa_align, f)</span>
<span id="cb59-9">  temp_output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(cur_mfa_align, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intern=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb59-10">  output_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_align_"</span>, f)</span>
<span id="cb59-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(output_name, temp_output, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">envir =</span> .GlobalEnv)</span>
<span id="cb59-12">}</span></code></pre></div>
</div>
<p>This for loop completes the MFA alignment. There is one final task remaining: creating a dataframe for further data analysis.</p>
</section>
</section>
</section>
<section id="our-task-list-3" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="our-task-list-3"><span class="header-section-number">5.3</span> Our Task List</h2>
<ul>
<li><del>Load the PCIbex results</del></li>
<li><del>Filter irrelevant sound files</del></li>
<li><del>Move all of our .wav and .TextGrid files to the same directory</del></li>
<li><del>Rename our files according to MFA guidelines</del></li>
<li><del>Run MFA</del></li>
<li>Create a dataframe</li>
</ul>
</section>
</section>
<section id="dataframe-creation" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Dataframe Creation</h1>
<p>Now that we have all our <code>.TextGrid</code> files aligned, we can create a dataframe for subsequent statistical analyses using the <code>readtextgrid</code> package. First, I’ll demonstrate the process for a single file. Later, I’ll explain how to extend this to an entire directory. Let’s begin by specifying our directory and listing the files. You can view the first few elements of a list or dataframe using the <code>head()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the directory and list files</span></span>
<span id="cb60-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/output"</span></span>
<span id="cb60-3">file_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> tg_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb60-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(file_list, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bpyuohtj_ballerina_unacc_pl_pl.TextGrid"
[2] "bpyuohtj_ballerina_unacc_pl_sg.TextGrid"
[3] "bpyuohtj_ballerina_unacc_sg_pl.TextGrid"
[4] "bpyuohtj_ballerina_unacc_sg_sg.TextGrid"
[5] "bpyuohtj_ballerina_unerg_pl_pl.TextGrid"</code></pre>
</div>
</div>
<section id="one-file-example-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="one-file-example-1"><span class="header-section-number">6.1</span> One-file example</h2>
<p>Again, let’s work with an example file from our list, starting with the first file <code>[1]</code>. First, we’ll retrieve its full file path. Then, we’ll use the <code>read_textgrid()</code> function to create a dataframe for this single file. I’ll print the structure of the dataframe to give you a clearer view of its contents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">example_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb62-2">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(tg_dir, example_file)</span>
<span id="cb62-3">example_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readtextgrid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_textgrid</span>(file_path)</span>
<span id="cb62-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(example_df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [36 × 10] (S3: tbl_df/tbl/data.frame)
 $ file          : chr [1:36] "bpyuohtj_ballerina_unacc_pl_pl.TextGrid" "bpyuohtj_ballerina_unacc_pl_pl.TextGrid" "bpyuohtj_ballerina_unacc_pl_pl.TextGrid" "bpyuohtj_ballerina_unacc_pl_pl.TextGrid" ...
 $ tier_num      : num [1:36] 1 1 1 1 1 1 1 1 1 1 ...
 $ tier_name     : chr [1:36] "words" "words" "words" "words" ...
 $ tier_type     : chr [1:36] "IntervalTier" "IntervalTier" "IntervalTier" "IntervalTier" ...
 $ tier_xmin     : num [1:36] 0 0 0 0 0 0 0 0 0 0 ...
 $ tier_xmax     : num [1:36] 2.52 2.52 2.52 2.52 2.52 2.52 2.52 2.52 2.52 2.52 ...
 $ xmin          : num [1:36] 0 0.57 0.61 1.11 1.37 ...
 $ xmax          : num [1:36] 0.57 0.61 1.11 1.37 1.43 ...
 $ text          : chr [1:36] "" "the" "ballerinas" "next" ...
 $ annotation_num: int [1:36] 1 2 3 4 5 6 7 8 9 10 ...</code></pre>
</div>
</div>
<p>In this project, which involves aligning words, we are interested in only a couple of these columns. Specifically, we focus on the file identifier (<code>file</code>) to determine the trial from which the data originates, the tier name (<code>tier_name</code>) to differentiate between word and phone tiers, the start (<code>xmin</code>) and end (<code>xmax</code>) of each interval, and finally, the <code>text</code>. Additionally, I am not interested in retaining the file extension in the <code>file</code> identifier. Therefore, we will first filter to include only annotated words, then select the important columns using <code>select()</code>, remove the <code>.TextGrid</code> extension, and concatenate the words so that we can see the full response for each trial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">example_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> example_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb64-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter annotated "words" tier</span></span>
<span id="cb64-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tier_name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"words"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb64-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select relevant columns</span></span>
<span id="cb64-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(file, xmin, xmax, text, annotation_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb64-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove .TextGrid and put the response together</span></span>
<span id="cb64-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>),</span>
<span id="cb64-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">response =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))</span>
<span id="cb64-9"></span>
<span id="cb64-10">example_df</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">file</th>
<th style="text-align: right;">xmin</th>
<th style="text-align: right;">xmax</th>
<th style="text-align: left;">text</th>
<th style="text-align: right;">annotation_num</th>
<th style="text-align: left;">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">0.5695</td>
<td style="text-align: right;">0.6095</td>
<td style="text-align: left;">the</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">0.6095</td>
<td style="text-align: right;">1.1095</td>
<td style="text-align: left;">ballerinas</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.1095</td>
<td style="text-align: right;">1.3695</td>
<td style="text-align: left;">next</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.3695</td>
<td style="text-align: right;">1.4295</td>
<td style="text-align: left;">to</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.4295</td>
<td style="text-align: right;">1.5495</td>
<td style="text-align: left;">the</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.5495</td>
<td style="text-align: right;">1.8995</td>
<td style="text-align: left;">axes</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.8995</td>
<td style="text-align: right;">1.9595</td>
<td style="text-align: left;">are</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpyuohtj_ballerina_unacc_pl_pl</td>
<td style="text-align: right;">1.9595</td>
<td style="text-align: right;">2.4895</td>
<td style="text-align: left;">shrinking</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">the ballerinas next to the axes are shrinking</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We also need some information about the trial. Luckily, all of our information is provided in our file name. So, I am going to parse that name to create a dataframe with more information. I am using a set of function that all start with <code>separate_wider_</code>.</p>
<ul>
<li>The <code>delim</code> version uses a deliminator to split a row of a dataframe.</li>
<li>The <code>regex</code> version uses regular expressions to split the data.</li>
<li>Finally, the <code>position</code> version uses the number of characters to split the data.</li>
</ul>
<p>I am doing all of this because of how I initially coded my experiment output in my PCIbex script. You may need to change this code to process your own data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">example_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> example_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb65-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># split the `file` column into 5 different columns.</span></span>
<span id="cb65-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_delim</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"headVerb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NumNum"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sem_type"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols_remove =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb65-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># split the headVerb column from the "U" character</span></span>
<span id="cb65-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_regex</span>(headVerb, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb65-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add the "U" character back to "Unacc" and "Unerg"s</span></span>
<span id="cb65-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, verb_type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb65-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># split the head and distractor numbers.</span></span>
<span id="cb65-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_position</span>(NumNum, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb65-10"></span>
<span id="cb65-11">example_df</span></code></pre></div>
</div>
</section>
<section id="another-treat-for-you" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="another-treat-for-you"><span class="header-section-number">6.2</span> Another Treat for you</h2>
<p>Let’s see what you will need to do. You will find your file in the <code>MFA/output</code> folder as well, and your file will look like <code>jtfr_squid_S.TextGrid</code>. Let’s arbitrarily put them here. Remember, you will have to use the <code>file.list()</code> function as well. You will not need to change anything in the first part where we work on the TextGrid. The necessary changes will need to be done in the parsing procedure. Instead of using the entire <code>regex</code> or <code>position</code> methods, you will just need to use the <code>delim</code> version of the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the directory and list files</span></span>
<span id="cb66-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/output"</span></span>
<span id="cb66-3">your_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jtfr_squid_S.TextGrid"</span></span>
<span id="cb66-4"></span>
<span id="cb66-5">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(tg_dir, your_file)</span>
<span id="cb66-6"></span>
<span id="cb66-7"></span>
<span id="cb66-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### LETS SAY YOU RAN read_textgrid function.</span></span>
<span id="cb66-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### I commented out this part, because I do not have your data.</span></span>
<span id="cb66-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Final dataframe will be slightly different here, because I do not have the textgrid data here.</span></span>
<span id="cb66-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># your_df &lt;- readtextgrid::read_textgrid(path = file_path) |&gt;</span></span>
<span id="cb66-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     filter(tier_name == "words" &amp; text != "") |&gt;</span></span>
<span id="cb66-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     select(file, xmin, xmax, text, annotation_num) |&gt;</span></span>
<span id="cb66-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     mutate(file = str_remove(file, "\\.TextGrid$"),</span></span>
<span id="cb66-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#            response = paste(text, collapse = " "))</span></span>
<span id="cb66-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   </span></span>
<span id="cb66-17"></span>
<span id="cb66-18">your_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> your_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb66-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_delim</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"head"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"condition"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols_remove =</span> F) </span>
<span id="cb66-20"></span>
<span id="cb66-21">your_df</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">subj</th>
<th style="text-align: left;">head</th>
<th style="text-align: left;">condition</th>
<th style="text-align: left;">file</th>
<th style="text-align: left;">xmin</th>
<th style="text-align: left;">xmax</th>
<th style="text-align: left;">text</th>
<th style="text-align: right;">annotation_num</th>
<th style="text-align: left;">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">jtfr</td>
<td style="text-align: left;">squid</td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">jtfr_squid_S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">squid</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">squid jumped over the fence</td>
</tr>
<tr class="even">
<td style="text-align: left;">jtfr</td>
<td style="text-align: left;">squid</td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">jtfr_squid_S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">jumped</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">squid jumped over the fence</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jtfr</td>
<td style="text-align: left;">squid</td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">jtfr_squid_S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">over</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">squid jumped over the fence</td>
</tr>
<tr class="even">
<td style="text-align: left;">jtfr</td>
<td style="text-align: left;">squid</td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">jtfr_squid_S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">the</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">squid jumped over the fence</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jtfr</td>
<td style="text-align: left;">squid</td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">jtfr_squid_S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">fence</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">squid jumped over the fence</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="for-loop-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="for-loop-1"><span class="header-section-number">6.3</span> For-loop</h2>
<p>Now, we need to apply this process to all files in our output directory. To simplify this, I’ll start by creating a function for processing each file individually and then apply it to all files. The function takes a file name and its directory as inputs and returns a dataframe. Before creating each dataframe, it prints “Reading the file.” to indicate progress.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1">process_textgrid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(file, directory) {</span>
<span id="cb67-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading"</span>, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb67-3">  file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(directory, file)</span>
<span id="cb67-4">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readtextgrid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_textgrid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> file_path) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tier_name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"words"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(file, xmin, xmax, text, annotation_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>),</span>
<span id="cb67-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">response =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))</span>
<span id="cb67-9">  </span>
<span id="cb67-10">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_delim</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"headVerb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NumNum"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sem_type"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols_remove =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_regex</span>(headVerb, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, verb_type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb67-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_position</span>(NumNum, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb67-15">  </span>
<span id="cb67-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb67-17">}</span></code></pre></div>
</div>
<p>This is essentially the same process as before, but encapsulated within a function for easier application. Here’s an example of how I’m redefining my directory and file list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the directory and list files</span></span>
<span id="cb68-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/output"</span></span>
<span id="cb68-3">file_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> tg_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb68-4">example_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb68-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">process_textgrid</span>(example_file, tg_dir)</span></code></pre></div>
</div>
<p>Your version will look like this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">process_textgrid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(file, directory) {</span>
<span id="cb69-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading"</span>, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb69-3">  file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(directory, file)</span>
<span id="cb69-4">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readtextgrid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_textgrid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> file_path) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb69-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tier_name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"words"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb69-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(file, xmin, xmax, text, annotation_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb69-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>),</span>
<span id="cb69-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">response =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))</span>
<span id="cb69-9">  </span>
<span id="cb69-10">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb69-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_delim</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"head"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"condition"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols_remove =</span> F) </span>
<span id="cb69-12">  </span>
<span id="cb69-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb69-14">}</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the directory and list files</span></span>
<span id="cb70-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/output"</span></span>
<span id="cb70-3">file_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> tg_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb70-4">example_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb70-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">process_textgrid</span>(example_file, tg_dir)</span></code></pre></div>
</div>
<p>Now, we need to integrate this function into our for-loop. Instead of using a single file like <code>file_list[1]</code>, we will apply it to an entire directory. Unlike previous for loops, we will use the <code>map</code> function from the <code>purrr</code> package. It is faster and easier to use in cases like this. <code>map()</code> will return all of our dataframes embedded in a list. After using <code>map()</code>, we need to combine all these smaller dataframes into a larger one using <code>bind_rows</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the directory and list files</span></span>
<span id="cb71-2">tg_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MFA/output"</span></span>
<span id="cb71-3">file_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> tg_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>)</span>
<span id="cb71-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run our function, I am using mine, you should use your own.</span></span>
<span id="cb71-5">process_textgrid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(file, directory) {</span>
<span id="cb71-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading"</span>, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb71-7">  file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(directory, file)</span>
<span id="cb71-8">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readtextgrid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_textgrid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> file_path) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tier_name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"words"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(file, xmin, xmax, text, annotation_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.TextGrid$"</span>),</span>
<span id="cb71-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">response =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))</span>
<span id="cb71-13">  </span>
<span id="cb71-14">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_delim</span>(file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"headVerb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NumNum"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sem_type"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols_remove =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_regex</span>(headVerb, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verb_type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U"</span>, verb_type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_position</span>(NumNum, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">head_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist_num =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb71-19">  </span>
<span id="cb71-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb71-21">}</span>
<span id="cb71-22"></span>
<span id="cb71-23">dfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(file_list, process_textgrid, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">directory =</span> tg_dir)</span>
<span id="cb71-24"></span>
<span id="cb71-25">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(dfs)</span></code></pre></div>
</div>
<p>This completes our MFA Aligning work. We have successfully completed every task on our list, aligned our data, and created a dataframe for analysis. You can check the structure of our final dataframe, the number of rows, and the count of unique trials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(final_df)</span>
<span id="cb72-2"></span>
<span id="cb72-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(final_df)</span>
<span id="cb72-4"></span>
<span id="cb72-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>file))</span></code></pre></div>
</div>
</section>
</section>
<section id="an-example-descriptive-summary" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> An Example Descriptive Summary</h1>
<p>Let me also show a small example of descriptive statistics using basic functions. One thing we might want to do is check whether there is a difference between conditions in people’s time to start uttering the sentence. Let’s assume people are still thinking about the sentence when they utter the first determiner “<em>the</em>,” since it is kind of automatic in English and all of our sentences start with this determiner anyway. I am going to filter my dataframe using the <code>text</code> column. Additionally, I want to ensure it is the first occurrence of “<em>the</em>” and not any other “<em>the</em>” in the sentences, so I will use the <code>annotation_num</code> column in my filtering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1">first_thes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"the"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> annotation_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</div>
<p>Then, what I am going to do is summarize my dataframe. I will group my dataframe by columns <code>verb_type</code> and <code>sem_type</code> since my experiment had 2 different verb types (unergative, unaccusative) and 2 different types of semantic distractors (related, unrelated). Then, I am going to use the <code>summarize()</code> function to get the mean, standard error, and credible interval for each condition. Since we are assuming people are still planning sentences while they utter the first determiner, I am going to summarize my data using the offset of the <em>the</em> (<code>xmax</code>). Before doing this, I am going to convert <code>xmax</code> from seconds to milliseconds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1">first_thes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(verb_type, sem_type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise_each</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">funs</span>(mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci=</span>se<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span>), xmax)</span></code></pre></div>
</div>
<p>From this point on, I leave the modeling and plotting of the data for another guide.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>On principle, I am against for loops in R, but it is better to use here instead of confusing you more.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{turk,
  author = {Turk, Utku},
  title = {Guidelines to {Run} {Montreal} {Forced} {Aligner} for a
    {PCIbex} {Experiment}},
  url = {https://utkuturk.github.io/digital-castle/posts/mfa/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-turk" class="csl-entry quarto-appendix-citeas">
Turk, Utku. n.d. <span>“Guidelines to Run Montreal Forced Aligner for a
PCIbex Experiment.”</span> <a href="https://utkuturk.github.io/digital-castle/posts/mfa/">https://utkuturk.github.io/digital-castle/posts/mfa/</a>.
</div></div></section></div> ]]></description>
  <guid>https://utkuturk.github.io/digital-castle/posts/mfa/</guid>
  <pubDate>Fri, 06 Dec 2024 17:21:17 GMT</pubDate>
</item>
</channel>
</rss>
